function u(){const t=Array.from(document.querySelectorAll("video")).filter((t=>0!=t.readyState)).filter((t=>!t.disablePictureInPicture)).sort(((t,e)=>{const i=t.getClientRects()[0]||{width:0,height:0},r=e.getClientRects()[0]||{width:0,height:0};return r.width*r.height-i.width*i.height}));if(0!==t.length)return t[0]}function s(t,e){const i=t[0].target;if(!document.querySelector("[__pip__]"))return void e.unobserve(i);const r=u();r&&!r.hasAttribute("__pip__")&&(e.unobserve(i),c(r))}async function c(t){await t.requestPictureInPicture(),t.setAttribute("__pip__","true"),t.addEventListener("leavepictureinpicture",(()=>{t.removeAttribute("__pip__")}),{once:!0}),new ResizeObserver(s).observe(t)}(async()=>{const t=u();if(t){if(t.hasAttribute("__pip__"))return void await document.exitPictureInPicture();await c(t)}})();